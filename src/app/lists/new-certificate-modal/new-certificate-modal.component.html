<h2 mat-dialog-title>Add Certificate</h2>

<form (ngSubmit)="onSubmit()">
  <mat-form-field appearance="fill">
    <mat-label>Certificate Type</mat-label>
    <mat-select [(ngModel)]="selectedCertificateTypeName" name="certType" (selectionChange)="onCertificateTypeChange()">
      <mat-option *ngFor="let type of certificateTypeOptions" [value]="type.name">
        {{ type.name }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <!-- Certificate Selector -->
<mat-form-field appearance="fill" *ngIf="filteredCertificates.length > 0 || selectedCertificateTypeName">
  <mat-label>Certificate</mat-label>
  <mat-select [(ngModel)]="selectedCertificateName" name="certName" (selectionChange)="onCertificateSelect()">
    
    <!-- Existing certificates -->
    <mat-option *ngFor="let cert of filteredCertificates" [value]="cert.name">
      {{ cert.name }}
    </mat-option>

    <!-- Divider -->
    <mat-divider></mat-divider>

    <!-- Add new -->
    <mat-option [value]="'custom'">
      + Add New Certificate
    </mat-option>
  </mat-select>
</mat-form-field>

<!-- Show custom input only if user selected 'Add New' -->
<mat-form-field appearance="fill" *ngIf="selectedCertificateName === '__custom__'">
  <mat-label>New Certificate Name</mat-label>
  <input matInput [(ngModel)]="name" name="name" required />
</mat-form-field>




  <mat-form-field appearance="fill">
    <mat-label>Issue Date</mat-label>
    <input matInput type="date" [(ngModel)]="issueDate" name="issueDate" required />
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Expire Date</mat-label>
    <input matInput type="date" [(ngModel)]="expireDate" name="expireDate" required />
  </mat-form-field>

  <div style="display: flex; justify-content: flex-end; gap: 10px;">
    <button mat-button type="button" (click)="onCancel()">Cancel</button>
    <button mat-flat-button color="primary" type="submit">Add</button>
  </div>
</form>
